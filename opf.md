# Optimal Power Flow (OPF)

An optimal power flow constitutes the core of power system operations. It is an optimization extension of the power flow analysis, where in addition to feasibility, an optimal dispatch is also desired. The objective of power system operation depends on the what kind of problem is being solved. Usually it is to serve the customers at the minimum cost, taking into consideration the physical constraints of the system. Optimal power flow can be expressed as an optimization problem and when security constraints are added it is referred to as security-constrained optimal power flow (SCOPF). In addition to power system operations, a solution to the optimal power flow is also essential for power system planning. 

In an OPF problem, the most important equations are about the representation of transmission branches. There are different approaches to model a transmission branch in a power system. The most commonly used representation of the transmission branch is called the π-model, which is what have adopted too.

<p align="center">
<img src="https://powersense.github.io//assets//opf//TransmissionModel.png" width="500" alt="Transmission Model">
</p>

The figure above shows a general representation of a π-model of a transmission branch, where y<sub>ij</sub> is the branch series admittance, y<sup>s</sup><sub>ij</sub> is the branch shunt admittance, yMij is the branch mutual admittance, and τ<sub>ij</sub> is the branch complex tap ratio. If a branch is only a transmission line then τ<sup>i</sup><sub>ij</sub>=1 and y<sup>M</sup><sub>ij</sub>=0. If a branch is only a transformer, then all the line parameters are zero. Thus, the figure represents a general model that can represent any type of transmission branch by simply adjusting the values of the parameters shown in the figure above.

## OPF Formulations

<img src="https://latex.codecogs.com/svg.latex?\Large&space;x=\frac{-b\pm\sqrt{b^2-4ac}}{2a}" title="something" />

<img src="https://latex.codecogs.com/svg.image?\bg_red&space;\begin{align*}&&space;min&&space;&&space;\sum_{\substack{g&space;\in&space;\mathcal{G}}}&space;c_{2g}&space;\cdot&space;(\Re[s_g])^2&space;&plus;&space;c_{1g}&space;\cdot&space;\Re[s_g]&space;&plus;&space;c_{0g}&space;\\&&space;\text{s.t.}&&space;&&space;s_{ij}=v_i&space;\cdot&space;(y^{net}_{ij}&space;\cdot&space;v_i&plus;Y_{ij}&space;\cdot&space;v_j)^*,&space;\;&space;\forall&space;\{i,j\}&space;\in&space;2\mathcal{K}.\\&&space;&&space;&&space;\sum_{\substack{g&space;\in&space;\mathcal{G}_n}}s_g&space;-&space;\sum_{\substack{d&space;\in&space;\mathcal{D}_n}}s_d=\sum_{\substack{k&space;\in&space;\mathcal{K}_n^f}}s_{nk}&plus;\sum_{\substack{k&space;\in&space;\mathcal{K}_n^t}}s_{kn}&space;&plus;Y^L_{n}\cdot&space;|v_n|^2,&space;\;&space;\forall&space;n&space;\in&space;\mathcal{N}.\\&&space;&&space;&&space;V_n^{Min}&space;\leq&space;|v_n|&space;\leq&space;V_n^{Max},&space;\;&space;\forall&space;n&space;\in&space;\mathcal{N}.&space;\\&&space;&&space;&&space;|s_{ij}|&space;\leq&space;I^{Max}_{ij}&space;\cdot&space;|v_n|,&space;\;&space;\forall&space;\{i,j\}&space;\in&space;2\mathcal{K}.&space;\\&&space;&&space;&&space;s_g^{Min}&space;\leq&space;s_g&space;\leq&space;s_g^{Max},&space;\;&space;\forall&space;g&space;\in&space;\mathcal{G}.\end{align*}" title="ACOPF complex problem" />

<img src="https://latex.codecogs.com/svg.image?\bg_red&space;\begin{subequations}\label{eq:ACOPF}\begin{align}&&space;\underset{}{\text{min}}&&space;&&space;\sum_{\substack{g&space;\in&space;\mathcal{G}}}&space;c_{2g}&space;\cdot&space;(\Re[s_g])^2&space;&plus;&space;c_{1g}&space;\cdot&space;\Re[s_g]&space;&plus;&space;c_{0g}&space;&space;\label{mainACOPF_obj}\\&&space;\text{s.t.}&&space;&&space;s_{ij}=v_i&space;\cdot&space;(y^{net}_{ij}&space;\cdot&space;v_i&plus;Y_{ij}&space;\cdot&space;v_j)^*,&space;\;&space;\forall&space;\{i,j\}&space;\in&space;2\mathcal{K}.&space;\label{eq:ACOPFsij}\\&&space;&&space;&&space;\sum_{\substack{g&space;\in&space;\mathcal{G}_n}}s_g&space;-&space;\sum_{\substack{d&space;\in&space;\mathcal{D}_n}}s_d=\sum_{\substack{k&space;\in&space;\mathcal{K}_n^f}}s_{nk}&plus;\sum_{\substack{k&space;\in&space;\mathcal{K}_n^t}}s_{kn}&space;\nonumber&space;\\&&space;&&space;&&space;\qquad&space;\qquad&space;\qquad&space;\qquad&space;\qquad&space;&plus;Y^L_{n}\cdot&space;|v_n|^2,&space;\;&space;\forall&space;n&space;\in&space;\mathcal{N}.&space;\label{eq:ACOPFsi0}\\&&space;&&space;&&space;V_n^{Min}&space;\leq&space;|v_n|&space;\leq&space;V_n^{Max},&space;\;&space;\forall&space;n&space;\in&space;\mathcal{N}.&space;\\&&space;&&space;&&space;|s_{ij}|&space;\leq&space;I^{Max}_{ij}&space;\cdot&space;|v_n|,&space;\;&space;\forall&space;\{i,j\}&space;\in&space;2\mathcal{K}.&space;\\&&space;&&space;&&space;s_g^{Min}&space;\leq&space;s_g&space;\leq&space;s_g^{Max},&space;\;&space;\forall&space;g&space;\in&space;\mathcal{G}.&space;\label{eq:ACOPF_sg}\end{align}\end{subequations}" title="\bg_red \begin{subequations}\label{eq:ACOPF}\begin{align}& \underset{}{\text{min}}& & \sum_{\substack{g \in \mathcal{G}}} c_{2g} \cdot (\Re[s_g])^2 + c_{1g} \cdot \Re[s_g] + c_{0g} \label{mainACOPF_obj}\\& \text{s.t.}& & s_{ij}=v_i \cdot (y^{net}_{ij} \cdot v_i+Y_{ij} \cdot v_j)^*, \; \forall \{i,j\} \in 2\mathcal{K}. \label{eq:ACOPFsij}\\& & & \sum_{\substack{g \in \mathcal{G}_n}}s_g - \sum_{\substack{d \in \mathcal{D}_n}}s_d=\sum_{\substack{k \in \mathcal{K}_n^f}}s_{nk}+\sum_{\substack{k \in \mathcal{K}_n^t}}s_{kn} \nonumber \\& & & \qquad \qquad \qquad \qquad \qquad +Y^L_{n}\cdot |v_n|^2, \; \forall n \in \mathcal{N}. \label{eq:ACOPFsi0}\\& & & V_n^{Min} \leq |v_n| \leq V_n^{Max}, \; \forall n \in \mathcal{N}. \\& & & |s_{ij}| \leq I^{Max}_{ij} \cdot |v_n|, \; \forall \{i,j\} \in 2\mathcal{K}. \\& & & s_g^{Min} \leq s_g \leq s_g^{Max}, \; \forall g \in \mathcal{G}. \label{eq:ACOPF_sg}\end{align}\end{subequations}" />
